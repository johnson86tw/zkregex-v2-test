use zkregex::utils::{
   select_subarray,
   captures::capture_substring,
   sparse_array::SparseArray,
   transitions::check_transition_with_captures
};

global TRANSITION_TABLE: SparseArray<1192, Field> = SparseArray {
    keys: [0x00000000, 0x00025250, 0x00025251, 0x00037574, 0x00041111, 0x00041212, 0x00041313, 0x00041414, 0x00041515, 0x00042828, 0x00044241, 0x0004888a, 0x0004888c, 0x0004898d, 0x00048a8e, 0x00048b8f, 0x00048c90, 0x00048d8e, 0x00048d91, 0x00048e92, 0x00048f93, 0x00049094, 0x00049195, 0x00049296, 0x0004a7ac, 0x0004a8a9, 0x0004b0b4, 0x0004b1b5, 0x0004b7bb, 0x0005cccb, 0x00068c91, 0x0006a6a7, 0x0007efec, 0x00089092, 0x00099394, 0x000af6f0, 0x000bf9f2, 0x000caab6, 0x000cb0ba, 0x000cb7bf, 0x000cbbca, 0x000cc1d1, 0x000ccedd, 0x000cd4d9, 0x000cf1e9, 0x000cf209, 0x000d9dab, 0x000d9ead, 0x000da5b3, 0x000da5b9, 0x000dadc1, 0x000db6c4, 0x000dc8cf, 0x000dc9d2, 0x000dc9d7, 0x000dc9de, 0x000dcddd, 0x000dced9, 0x000dcfde, 0x000df5ec, 0x000df60c, 0x000e9da3, 0x000ea1b4, 0x000ec0c8, 0x000ec7d5, 0x000ed1db, 0x000efbf1, 0x000efc11, 0x000f9fab, 0x000fc3c5, 0x000fc5c7, 0x000fc7c9, 0x000fc9cb, 0x000fcbcd, 0x000fcdcf, 0x000fcfd1, 0x000fd1d3, 0x000fd3d5, 0x000fd5d7, 0x0010a2a6, 0x0010a7b2, 0x0010b1bc, 0x0010b3be, 0x0010b9c4, 0x0010c0c4, 0x0010c3c9, 0x0010c5d0, 0x0010c5d6, 0x0010c7cb, 0x0010c9cf, 0x0010cdd1, 0x0010cdd9, 0x0010d1dc, 0x0010d5e0, 0x0010d9da, 0x0010dbdc, 0x0010dce3, 0x0010dde8, 0x001202f5, 0x00120315, 0x0012c9cb, 0x0013d0d1, 0x0013d7d8, 0x001509f9, 0x00150a19, 0x0015d1d2, 0x00171704, 0x00171724, 0x00181e0a, 0x00181e2a, 0x0018c0cb, 0x0019b6b8, 0x001acfd0, 0x001bc7cf, 0x001cced5, 0x001dd6dc, 0x001edbdc, 0x001fdbdf, 0x0020d7d8, 0x0021e0e2, 0x0022e3e4, 0x00243717, 0x00243737, 0x00247858, 0x00247878, 0x00247959, 0x00247979, 0x00247a5a, 0x00247a7a, 0x00247b5b, 0x00247b7b, 0x00247c5c, 0x00247c7c, 0x00247d5d, 0x00247d7d, 0x00247e5e, 0x00247e7e, 0x00247f5f, 0x00247f7f, 0x00248060, 0x00248080, 0x00248161, 0x00248181, 0x0024c8b2, 0x0024c8b7, 0x0024c8be, 0x0024c9b3, 0x0024c9b8, 0x0024c9bf, 0x0024cab4, 0x0024cab9, 0x0024cac0, 0x0024cbb5, 0x0024cbba, 0x0024cbc1, 0x0024ccb6, 0x0024ccbb, 0x0024ccc2, 0x0024cdb7, 0x0024cdbc, 0x0024cdc3, 0x0024ceb8, 0x0024cebc, 0x0024cebd, 0x0024cec4, 0x0024cfb9, 0x0024cfbd, 0x0024cfbe, 0x0024cfc5, 0x0024d0ba, 0x0024d0be, 0x0024d0bf, 0x0024d0c6, 0x0024d1bb, 0x0024d1bf, 0x0024d1c0, 0x0024d1c7, 0x0024d2c0, 0x0024d3c1, 0x0024d4c2, 0x0024d5c3, 0x0024d6c4, 0x0024d6d0, 0x0024d7c5, 0x0024d7d1, 0x0024d8c4, 0x0024d8c7, 0x0024d8c9, 0x0024d8ce, 0x0024d8d2, 0x0024d9c5, 0x0024d9c8, 0x0024d9ca, 0x0024d9cf, 0x0024d9d3, 0x0024dac6, 0x0024dac9, 0x0024dacb, 0x0024dad0, 0x0024dad4, 0x0024dbc7, 0x0024dbca, 0x0024dbcc, 0x0024dbd1, 0x0024dbd5, 0x0024dcc8, 0x0024dccb, 0x0024dccd, 0x0024dcd2, 0x0024dcd6, 0x0024ddc9, 0x0024ddcc, 0x0024ddce, 0x0024ddd3, 0x0024ddd7, 0x0024deca, 0x0024decd, 0x0024decf, 0x0024ded4, 0x0024ded8, 0x0024dfcb, 0x0024dfce, 0x0024dfd0, 0x0024dfd5, 0x0024dfd9, 0x0024e0cc, 0x0024e0cf, 0x0024e0d1, 0x0024e0d6, 0x0024e0da, 0x0024e1cd, 0x0024e1d0, 0x0024e1d2, 0x0024e1d7, 0x0024e1db, 0x0024e2d8, 0x0024e2dc, 0x0024e3d9, 0x0024e3dd, 0x0024e4da, 0x0024e4de, 0x0024e5db, 0x0024e5df, 0x0024e6dc, 0x0024e6e0, 0x0024e7dd, 0x0024e7e1, 0x0024e8d0, 0x0024e8de, 0x0024e8e2, 0x0024e9d1, 0x0024e9df, 0x0024e9e3, 0x0024ead2, 0x0024eae0, 0x0024eae4, 0x0024ebd3, 0x0024ebe1, 0x0024ebe5, 0x0024ecd4, 0x0024ece6, 0x0024edd5, 0x0024ede7, 0x0024eed6, 0x0024eed9, 0x0024eee8, 0x0024efd7, 0x0024efda, 0x0024efe9, 0x0024f0d8, 0x0024f0db, 0x0024f0ea, 0x0024f1d9, 0x0024f1dc, 0x0024f1eb, 0x0024f2dd, 0x0024f2ec, 0x0024f3de, 0x0024f3ed, 0x0024f4df, 0x0024f4ee, 0x0024f5e0, 0x0024f5ef, 0x0024f6e1, 0x0024f6f0, 0x0024f7e2, 0x0024f7f1, 0x0024f8e1, 0x0024f8e9, 0x0024f8f2, 0x0024f9e2, 0x0024f9ea, 0x0024f9f3, 0x0024f9f5, 0x0024fae3, 0x0024faeb, 0x0024faf4, 0x0024faf6, 0x0024fbe4, 0x0024fbec, 0x0024fbf5, 0x0024fbf7, 0x0024fce5, 0x0024fced, 0x0024fcf6, 0x0024fcf8, 0x0024fde6, 0x0024fdee, 0x0024fdf7, 0x0024fdf9, 0x0024fee7, 0x0024feef, 0x0024fef3, 0x0024fef8, 0x0024fefa, 0x0024ffe8, 0x0024fff0, 0x0024fff4, 0x0024fff9, 0x0024fffb, 0x002500e9, 0x002500f1, 0x002500f5, 0x002500fa, 0x002500fc, 0x002501ea, 0x002501f2, 0x002501f6, 0x002501fb, 0x002501fd, 0x002502f7, 0x002502fc, 0x002502fe, 0x002503f8, 0x002503fd, 0x002504f9, 0x002504fe, 0x002505fa, 0x002505ff, 0x002506fb, 0x00250700, 0x002507fc, 0x00250801, 0x00254a49, 0x00254a4a, 0x00254b4a, 0x00254b4b, 0x00254c4b, 0x00254c4c, 0x00254d4c, 0x00254d4d, 0x00254e4d, 0x00254e4e, 0x00254f4e, 0x00254f4f, 0x0025504f, 0x00255050, 0x00255150, 0x00255151, 0x00255251, 0x00255252, 0x00255352, 0x00255353, 0x00255554, 0x00255555, 0x00255655, 0x00255656, 0x00255756, 0x00255757, 0x00255857, 0x00255858, 0x00255958, 0x00255959, 0x00255a59, 0x00255a5a, 0x00255b5a, 0x00255b5b, 0x00255c5b, 0x00255c5c, 0x00255d5c, 0x00255d5d, 0x00255e5d, 0x00255e5e, 0x00255f5e, 0x00255f5f, 0x0025605f, 0x00256060, 0x00256160, 0x00256161, 0x00256261, 0x00256262, 0x00256362, 0x00256363, 0x00256463, 0x00256464, 0x00256564, 0x00256565, 0x00256665, 0x00256666, 0x00256766, 0x00256767, 0x00256867, 0x00256868, 0x00256968, 0x00256969, 0x00256a69, 0x00256a6a, 0x00256b6a, 0x00256b6b, 0x00256c6b, 0x00256c6c, 0x00256d6c, 0x00256d6d, 0x00256e6d, 0x00256e6e, 0x00256f6e, 0x00256f6f, 0x0025706f, 0x00257070, 0x00257170, 0x00257171, 0x00257271, 0x00257272, 0x00257372, 0x00257373, 0x00257473, 0x00257474, 0x00257574, 0x00257575, 0x00257675, 0x00257676, 0x00257776, 0x00257777, 0x00257877, 0x00257878, 0x00257978, 0x00257979, 0x00257a79, 0x00257a7a, 0x00257b7a, 0x00257b7b, 0x00257c7b, 0x00257c7c, 0x00257d7c, 0x00257d7d, 0x00257e7d, 0x00257e7e, 0x00257f7e, 0x00257f7f, 0x0025807f, 0x00258080, 0x00258180, 0x00258181, 0x00258281, 0x00258282, 0x00258382, 0x00258383, 0x00258483, 0x00258484, 0x00258584, 0x00258585, 0x00258685, 0x00258686, 0x00258786, 0x00258787, 0x00258887, 0x00258888, 0x00258988, 0x00258989, 0x00258a89, 0x00258a8a, 0x00258b8a, 0x00258b8b, 0x00258c8b, 0x00258c8c, 0x00258d8c, 0x00258d8d, 0x00258e8d, 0x00258e8e, 0x00258f8e, 0x00258f8f, 0x0025908f, 0x00259090, 0x00259190, 0x00259191, 0x00259291, 0x00259292, 0x00259392, 0x00259393, 0x00259493, 0x00259494, 0x00259594, 0x00259595, 0x00259695, 0x00259696, 0x00259796, 0x00259797, 0x00259897, 0x00259898, 0x00259998, 0x00259999, 0x00259a99, 0x00259a9a, 0x00259b9a, 0x00259b9b, 0x00259c9b, 0x00259c9c, 0x00259d9c, 0x00259d9d, 0x00259e9d, 0x00259e9e, 0x00259f9e, 0x00259f9f, 0x0025a09f, 0x0025a0a0, 0x0025a1a0, 0x0025a1a1, 0x0025a2a1, 0x0025a2a2, 0x0025a3a2, 0x0025a3a3, 0x0025a4a3, 0x0025a4a4, 0x0025a5a4, 0x0025a5a5, 0x0025a6a5, 0x0025a6a6, 0x0025a7a6, 0x0025a7a7, 0x0025a8a7, 0x0025a8a8, 0x0025a9a8, 0x0025a9a9, 0x0025aaa9, 0x0025aaaa, 0x0025abaa, 0x0025abab, 0x0025acab, 0x0025acac, 0x0025adac, 0x0025adad, 0x0025aead, 0x0025aeae, 0x0025afae, 0x0025afaf, 0x0025b0af, 0x0025b0b0, 0x0025b1b0, 0x0025b1b1, 0x0025b2b1, 0x0025b2b2, 0x0025b3b2, 0x0025b3b3, 0x0025b4b3, 0x0025b4b4, 0x0025b5b4, 0x0025b5b5, 0x0025b6b5, 0x0025b6b6, 0x0025b7b6, 0x0025b7b7, 0x0025b8b7, 0x0025b8b8, 0x0025b9b8, 0x0025b9b9, 0x0025bab9, 0x0025baba, 0x0025bbba, 0x0025bbbb, 0x0025bcbb, 0x0025bcbc, 0x0025bdbc, 0x0025bdbd, 0x0025bebd, 0x0025bebe, 0x0025bfbe, 0x0025bfbf, 0x0025c0bf, 0x0025c0c0, 0x0025c1c0, 0x0025c1c1, 0x0025c2c1, 0x0025c2c2, 0x0025c3c2, 0x0025c3c3, 0x0025c4c3, 0x0025c4c4, 0x0025c5c4, 0x0025c5c5, 0x0025c6c5, 0x0025c6c6, 0x0025c7c6, 0x0025c7c7, 0x0025c8c7, 0x0025c8c8, 0x0025c9c8, 0x0025c9c9, 0x0025cacb, 0x0025cbcc, 0x0025cccd, 0x0025cdce, 0x0025cecf, 0x0025cfd0, 0x0025d0d1, 0x0025d1d2, 0x0025d2d3, 0x0025d3d4, 0x0025d4d5, 0x0025d5d6, 0x0025d6d7, 0x0025d7d8, 0x0025d8d9, 0x0025d9da, 0x0025dadb, 0x0025dbdc, 0x0025dcdd, 0x0025ddde, 0x0025dedf, 0x0025dfe0, 0x0025e0e1, 0x0025e1e2, 0x0025e2e3, 0x0025e3e4, 0x0025e4e5, 0x0025e5e6, 0x0025e6e7, 0x0025e7e8, 0x0025e8e9, 0x0025e9ea, 0x0025eaeb, 0x0025ebec, 0x0025eced, 0x0025edee, 0x0025eeef, 0x0025eff0, 0x0025f0f1, 0x0025f1f2, 0x0025f2f3, 0x0025f3f4, 0x0025f4f5, 0x0025f5f6, 0x0025f6f7, 0x0025f7f8, 0x0025f8f9, 0x0025f9fa, 0x0025fafb, 0x0025fbfc, 0x0025fcfd, 0x0025fdfe, 0x0025feff, 0x00260000, 0x00260101, 0x00260202, 0x00260303, 0x00260404, 0x00260505, 0x00260606, 0x00260707, 0x00260808, 0x00260909, 0x00260a0a, 0x0026ccce, 0x0026cccf, 0x0026cdcf, 0x0026cdd0, 0x0026ced0, 0x0026ced1, 0x0026cfd1, 0x0026cfd2, 0x0026d0d2, 0x0026d0d3, 0x0026d1d3, 0x0026d1d4, 0x0026d2d4, 0x0026d2d5, 0x0026d3d5, 0x0026d3d6, 0x0026d4d6, 0x0026d4d7, 0x0026d5d7, 0x0026d5d8, 0x0026d6d8, 0x0026d6d9, 0x0026d7d9, 0x0026d7da, 0x0026d8da, 0x0026d8db, 0x0026d9db, 0x0026d9dc, 0x0026dadc, 0x0026dadd, 0x0026dbdd, 0x0026dbde, 0x0026dcde, 0x0026dcdf, 0x0026dddf, 0x0026dde0, 0x0026dee0, 0x0026dee1, 0x0026dfe1, 0x0026dfe2, 0x0026e0e2, 0x0026e0e3, 0x0026e1e3, 0x0026e1e4, 0x0026e2e4, 0x0026e2e5, 0x0026e3e5, 0x0026e3e6, 0x0026e4e6, 0x0026e4e7, 0x0026e5e7, 0x0026e5e8, 0x0026e6e8, 0x0026e6e9, 0x0026e7e9, 0x0026e7ea, 0x0026e8ea, 0x0026e8eb, 0x0026e9eb, 0x0026e9ec, 0x0026eaec, 0x0026eaed, 0x0026ebed, 0x0026ebee, 0x0026eced, 0x0026ecee, 0x0026edee, 0x0026edef, 0x0026eeef, 0x0026eef0, 0x0026eff0, 0x0026eff1, 0x0026f0f1, 0x0026f0f2, 0x0026f1f2, 0x0026f1f3, 0x0026f2f3, 0x0026f2f4, 0x0026f3f4, 0x0026f3f5, 0x0026f4f5, 0x0026f4f6, 0x0026f5f6, 0x0026f5f7, 0x0026f6f7, 0x0026f6f8, 0x0026f7f8, 0x0026f7f9, 0x0026f8f9, 0x0026f8fa, 0x0026f9fa, 0x0026f9fb, 0x0026fafb, 0x0026fafc, 0x0026fbfc, 0x0026fbfd, 0x0026fcfd, 0x0026fcfe, 0x0026fdfe, 0x0026fdff, 0x0026feff, 0x0026ff00, 0x00270000, 0x00270001, 0x00270101, 0x00270102, 0x00270202, 0x00270203, 0x00270303, 0x00270304, 0x00270404, 0x00270405, 0x00270505, 0x00270506, 0x00270606, 0x00270607, 0x00270707, 0x00270708, 0x00270808, 0x00270809, 0x00270909, 0x0027090a, 0x00270a0a, 0x00270a0b, 0x00270b0b, 0x00270b0c, 0x00270c0c, 0x00270c0d, 0x00270f0c, 0x00270f0d, 0x0027100d, 0x0027100e, 0x0027110e, 0x0027110f, 0x0027120f, 0x00271210, 0x00271310, 0x00271311, 0x00271411, 0x00271412, 0x00271512, 0x00271513, 0x00271613, 0x00271614, 0x00271714, 0x00271715, 0x00271815, 0x00271816, 0x00271916, 0x00271917, 0x00271a17, 0x00271a18, 0x00271b18, 0x00271b19, 0x00271c19, 0x00271c1a, 0x00271d1a, 0x00271d1b, 0x00271e1b, 0x00271e1c, 0x00271f1c, 0x00271f1d, 0x0027201d, 0x0027201e, 0x0027211e, 0x0027211f, 0x0027221f, 0x00272220, 0x00272320, 0x00272321, 0x00272421, 0x00272422, 0x00272522, 0x00272523, 0x00272623, 0x00272624, 0x00272724, 0x00272725, 0x00272825, 0x00272826, 0x00272926, 0x00272927, 0x00272a27, 0x00272a28, 0x00272b28, 0x00272b29, 0x00272c29, 0x00272c2a, 0x00282f2b, 0x00282f2c, 0x0028d0d3, 0x0028d0d4, 0x0028d1d4, 0x0028d1d5, 0x0028d2d5, 0x0028d2d6, 0x0028d3d6, 0x0028d3d7, 0x0028d4d7, 0x0028d4d8, 0x0028d5d8, 0x0028d5d9, 0x0028d6d9, 0x0028d6da, 0x0028d7da, 0x0028d7db, 0x0028d8db, 0x0028d8dc, 0x0028d9dc, 0x0028d9dd, 0x0028dadd, 0x0028dade, 0x0028dbde, 0x0028dbdf, 0x0028dcdf, 0x0028dce0, 0x0028dde0, 0x0028dde1, 0x0028dee1, 0x0028dee2, 0x0028dfe2, 0x0028dfe3, 0x0028e0e2, 0x0028e0e3, 0x0028e1e3, 0x0028e1e4, 0x0028e2e4, 0x0028e2e5, 0x0028e3e5, 0x0028e3e6, 0x0028e4e6, 0x0028e4e7, 0x0028e5e7, 0x0028e5e8, 0x0028e6e8, 0x0028e6e9, 0x0028e7e9, 0x0028e7ea, 0x0028e8ea, 0x0028e8eb, 0x0028e9eb, 0x0028e9ec, 0x0028eaec, 0x0028eaed, 0x0028ebed, 0x0028ebee, 0x0028ecee, 0x0028ecef, 0x0028edef, 0x0028edf0, 0x0028eef0, 0x0028eef1, 0x0028eff1, 0x0028eff2, 0x0028f0f2, 0x0028f0f3, 0x0028f1f3, 0x0028f1f4, 0x0028f2f4, 0x0028f2f5, 0x0028f3f5, 0x0028f3f6, 0x0028f4f6, 0x0028f4f7, 0x0028f5f7, 0x0028f5f8, 0x0028f6f8, 0x0028f6f9, 0x0028f7f9, 0x0028f7fa, 0x0028f8fa, 0x0028f8fb, 0x0028f9fb, 0x0028f9fc, 0x0028fafc, 0x0028fafd, 0x0028fbfd, 0x0028fbfe, 0x0028fcfe, 0x0028fcff, 0x0028fdff, 0x0028fe00, 0x0028ff00, 0x0028ff01, 0x00290001, 0x00290002, 0x00290102, 0x00290103, 0x00290203, 0x00290204, 0x00290304, 0x00290305, 0x00290405, 0x00290406, 0x00290506, 0x00290507, 0x00290607, 0x00290608, 0x00290708, 0x00290709, 0x00290809, 0x0029080a, 0x0029090a, 0x0029090b, 0x00290a0b, 0x00290a0c, 0x00290b0c, 0x00290b0d, 0x00290c0d, 0x00290c0e, 0x00290d0e, 0x00290d0f, 0x00290e0f, 0x00290e10, 0x00290f10, 0x00290f11, 0x00291011, 0x00291012, 0x0029322d, 0x0029322e, 0x0029332e, 0x0029332f, 0x0029342f, 0x00293430, 0x00293530, 0x00293531, 0x00293631, 0x00293632, 0x00293732, 0x00293733, 0x00293833, 0x00293834, 0x00293934, 0x00293935, 0x00293a35, 0x00293a36, 0x00293b36, 0x00293b37, 0x00293c37, 0x00293c38, 0x00293d38, 0x00293d39, 0x00293f3a, 0x00293f3b, 0x0029403b, 0x0029403c, 0x002a403a, 0x002a403b, 0x002b453e, 0x002b453f, 0x002c4840, 0x002c4841, 0x002c4941, 0x002c4942, 0x002c4a42, 0x002c4a43, 0x002d4d44, 0x002d4d45, 0x002d675e, 0x002d675f, 0x002e6665, 0x002fa7a6, 0x0030a4a3, 0x00316b6b, 0x00316c6c, 0x00316d6d, 0x00316e6e, 0x00316f6f, 0x00318282, 0x00319c9b, 0x0031e2e4, 0x0031e2e6, 0x0031e3e7, 0x0031e4e8, 0x0031e5e9, 0x0031e6ea, 0x0031e7e8, 0x0031e7eb, 0x0031e8ec, 0x0031e9ed, 0x0031eaee, 0x0031ebef, 0x0031ecf0, 0x00320206, 0x00320303, 0x00320b0e, 0x00320c0f, 0x00321215, 0x00332725, 0x0033e6eb, 0x00340101, 0x00354a46, 0x0035eaec, 0x0036edee, 0x0038514a, 0x0039544c, 0x0039a29a, 0x003aeceb, 0x003ba6a5, 0x003ba6a6, 0x003ba7a6, 0x003ba7a7, 0x003ba8a7, 0x003ba8a8, 0x003ba9a8, 0x003ba9a9, 0x003baaa9, 0x003baaaa, 0x003babaa, 0x003babab, 0x003bacab, 0x003bacac, 0x003badac, 0x003badad, 0x003baead, 0x003baeae, 0x003bafae, 0x003bafaf, 0x003bb7b6, 0x003bb7b7, 0x003bb8b7, 0x003bb8b8, 0x003bb9b8, 0x003bb9b9, 0x003bbab9, 0x003bbaba, 0x003bbbba, 0x003bbbbb, 0x003bbcbb, 0x003bbcbc, 0x003bd7d6, 0x003bd7d7, 0x003bd8d7, 0x003bd8d8, 0x003bd9d8, 0x003bd9d9, 0x003bdad9, 0x003bdada, 0x003bdbda, 0x003bdbdb, 0x003bdcdb, 0x003bdcdc, 0x003c8584, 0x003d8483, 0x003ececd, 0x003fe3e2, 0x0040e3e2, 0x0041ebea, 0x0042f4f3, 0x0043efee, 0x0044edec, 0x0045f8f7, 0x004700ff, 0x00479797, 0x00479898, 0x00479999, 0x00479a9a, 0x00479b9b, 0x0047aeae, 0x0047c8c7, 0x00480f10, 0x00480f12, 0x00481013, 0x00481114, 0x00481215, 0x00481316, 0x00481414, 0x00481417, 0x00481518, 0x00481619, 0x0048171a, 0x0048181b, 0x0048191c, 0x00482e32, 0x00482f2f, 0x0048373a, 0x0048383b, 0x00483e41, 0x00495351, 0x004a1317, 0x004a2d2d, 0x004b7672, 0x004c1718, 0x004d1a1a, 0x004e7d76, 0x004f8078, 0x004fcec6, 0x00511917, 0x0051d2d1, 0x0051d2d2, 0x0051d3d2, 0x0051d3d3, 0x0051d4d3, 0x0051d4d4, 0x0051d5d4, 0x0051d5d5, 0x0051d6d5, 0x0051d6d6, 0x0051d7d6, 0x0051d7d7, 0x0051d8d7, 0x0051d8d8, 0x0051d9d8, 0x0051d9d9, 0x0051dad9, 0x0051dada, 0x0051dbda, 0x0051dbdb, 0x0051e3e2, 0x0051e3e3, 0x0051e4e3, 0x0051e4e4, 0x0051e5e4, 0x0051e5e5, 0x0051e6e5, 0x0051e6e6, 0x0051e7e6, 0x0051e7e7, 0x0051e8e7, 0x0051e8e8, 0x00520402, 0x00520403, 0x00520503, 0x00520504, 0x00520604, 0x00520605, 0x00520705, 0x00520706, 0x00520806, 0x00520807, 0x00520907, 0x00520908, 0x0052a2a1],
    values: [0x00000000, 0x00000000, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000013, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000013, 0x00000001, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000013, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000011, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000025, 0x00000001, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000021, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000001, 0x00000049, 0x00000001, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000041, 0x00000000],
    maximum: 0x0052a2a1
};

pub global CAPTURE_1_MAX_LENGTH: u32 = 5;
pub global CAPTURE_2_MAX_LENGTH: u32 = 66;
pub global CAPTURE_3_MAX_LENGTH: u32 = 42;
pub global NUM_CAPTURE_GROUPS: u32 = 3;

/**
 * Constrains a start state to be valid
 * @dev start states are hardcoded in this function - "(start_state - {state})" for each start
 *      example: `(start_state - 0) * (start_state - 1) * (start_state - 2)` means 0, 1, or 2
 *      are valid first states
 * 
 * @param start_state - The start state of the NFA
 */
fn check_start_state(start_state: Field) {
    let valid_start_state = (start_state - 0) * (start_state - 1);
    assert(valid_start_state == 0, "Invalid start state");
}
    
/**
 * Constrains the recognition of accept_state being reached. If an aceppt state is reached,
 *      ensures asserted traversal path is valid
 * @dev accept states are hardcoded in this function - "(next_state - {state})" for each accept
 *      example: `(next_state - 19) * (next_state - 20) * (next_state - 21)` means 19, 20, or 21
 *      are valid accept states
 * 
 * @param next_state - The asserted next state of the NFA
 * @param haystack_index - The index being operated on in the haystack
 * @param asserted_match_length - The asserted traversal path length
 * @return - 0 if accept_state is reached, nonzero otherwise
 */
fn check_accept_state(
    next_state: Field,
    haystack_index: Field, 
    asserted_match_length: Field
) -> Field {
    // check if the next state is an accept state
    let accept_state_reached = (next_state - 81);
    let accept_state_reached_bool = (accept_state_reached == 0) as Field;

    // check if the haystack index is the asserted match length
    // should equal 1 since haystack_index should be 1 less than asserted_match)length
    let asserted_path_traversed = (asserted_match_length - haystack_index == 1) as Field;

    (1 - (accept_state_reached_bool * asserted_path_traversed))
}

/**
 * RacBodyRegex matching function
 * Regex: No:\\s*(\\d+).*\\r\\nID:\\s*(0x[0-9a-fA-F]+)\\r\\nRecipient:\\s*(0x[0-9a-fA-F]+)
 * @param in_haystack - The input haystack to search from
 * @param match_start - The start index in the haystack for the subarray to match from
 * @param match_length - The length of the subarray to extract from haystack
 * @param current_states - The current states of the NFA at each index in the match subarray
 * @param next_states - The next states of the NFA at each index in the match subarray
 * @param capture_group_<group>_ids - The ids of the capture groups in the match subarray
 * @param capture_group_<group>_starts - The start positions of the capture groups in the match subarray
 * @param capture_group_start_indices - The start indices of the capture groups in the match subarray
 * @return - tuple of substring captures as dictated by the regular expression
 */
pub fn regex_match<let MAX_HAYSTACK_LEN: u32, let MAX_MATCH_LEN: u32>(
    in_haystack: [u8; MAX_HAYSTACK_LEN],
    match_start: u32,
    match_length: u32,
    current_states: [Field; MAX_MATCH_LEN],
    next_states: [Field; MAX_MATCH_LEN],
    capture_group_1_id: [Field; MAX_MATCH_LEN],
    capture_group_2_id: [Field; MAX_MATCH_LEN],
    capture_group_3_id: [Field; MAX_MATCH_LEN],
    capture_group_1_start: [Field; MAX_MATCH_LEN],
    capture_group_2_start: [Field; MAX_MATCH_LEN],
    capture_group_3_start: [Field; MAX_MATCH_LEN],
    capture_group_start_indices: [Field; NUM_CAPTURE_GROUPS],
) -> (BoundedVec<u8, CAPTURE_1_MAX_LENGTH>, BoundedVec<u8, CAPTURE_2_MAX_LENGTH>, BoundedVec<u8, CAPTURE_3_MAX_LENGTH>) {
    // resize haystack 
    let haystack: [u8; MAX_MATCH_LEN] = select_subarray::<MAX_HAYSTACK_LEN, MAX_MATCH_LEN>(in_haystack, match_start, match_length);

    check_start_state(current_states[0]);
    for i in 0..MAX_MATCH_LEN-1 {
        // match length - 1 since current states should be 1 less than next states
        let in_range = (i < match_length - 1) as Field;
        let matching_states = current_states[i + 1] - next_states[i];
        assert(in_range * matching_states == 0, "Invalid Transition Input");
    }
    let mut reached_end_state = 1;
    for i in 0..MAX_MATCH_LEN {
        let active_capture_groups_at_index = [capture_group_1_id[i], capture_group_2_id[i], capture_group_3_id[i]];
        let active_capture_groups_starts_at_index = [capture_group_1_start[i], capture_group_2_start[i], capture_group_3_start[i]];
        check_transition_with_captures(
            TRANSITION_TABLE,
            haystack[i] as Field,
            current_states[i],
            next_states[i],
            active_capture_groups_at_index,
            active_capture_groups_starts_at_index,
            reached_end_state
        );
        reached_end_state = reached_end_state * check_accept_state(next_states[i], i as Field, match_length as Field);
    }
    assert(reached_end_state == 0, "Did not reach a valid end state");

    // Capture Group 1
    let capture_1 = capture_substring::<MAX_MATCH_LEN, CAPTURE_1_MAX_LENGTH, 1>(
       haystack,
       capture_group_1_id,
       capture_group_1_start,
       capture_group_start_indices[0]
    );

    // Capture Group 2
    let capture_2 = capture_substring::<MAX_MATCH_LEN, CAPTURE_2_MAX_LENGTH, 2>(
       haystack,
       capture_group_2_id,
       capture_group_2_start,
       capture_group_start_indices[1]
    );

    // Capture Group 3
    let capture_3 = capture_substring::<MAX_MATCH_LEN, CAPTURE_3_MAX_LENGTH, 3>(
       haystack,
       capture_group_3_id,
       capture_group_3_start,
       capture_group_start_indices[2]
    );

    (capture_1, capture_2, capture_3)
}

